# INSERT INTO archelect.odpe_consultas (id_odpe, id_consulta, id_proceso, created_at, updated_at)
SELECT o.id, c.id, p.id, now(), now()
FROM (SELECT NOM_ODPE, COD_CONSULTA, COD_PROCESO
      FROM sufragio_nacional_vertical
      GROUP BY NOM_ODPE, COD_CONSULTA, COD_PROCESO
      ORDER BY NOM_ODPE) as snv
         INNER JOIN procesos p ON snv.COD_PROCESO = p.proceso
         INNER JOIN consultas c on snv.COD_CONSULTA = c.consulta
         INNER JOIN odpes o ON snv.NOM_ODPE = o.nombre_odpe


select * FROM sufragio_nacional_vertical
WHERE NOM_ODPE= 'ABANCAY' AND DEPAR_UBI= 'APURIMAC' AND PROV_UBI = 'ABANCAY';

SELECT COD_CONSULTA, count(COD_CONSULTA) FROM sufragio_nacional_vertical group by COD_CONSULTA;
/*
P
PD
RP
RPD
*/
select * from consultas;
SELECT c.id, c.descripcion
                    FROM odpe_consultas oc INNER JOIN consultas c on c.id = oc.id_consulta INNER JOIN ubigeos u on oc.id_odpe = u.id_odpe
                    WHERE oc.id_proceso = 1 AND oc.id_odpe = 1
                    AND u.id_departamento = 3 AND id_provincia=1 AND id_distrito=251 ORDER BY c.id;

# WHERE p.id = 1 AND o.id = 1;

select * from odpes;

SELECT o.id,o.nombre_odpe
					FROM procesos p INNER JOIN proceso_odpes po ON p.id = po.id_proceso
					INNER JOIN odpes o INNER JOIN odpe_soluciones os ON o.id = os.id_odpe
					WHERE p.id = $this->intIdProceso AND os.id_solucion = $this->intIdSolucion
					GROUP BY o.id, o.nombre_odpe
					ORDER BY o.nombre_odpe;

SELECT o.nombre_odpe, count(o.nombre_odpe) AS conteo FROM odpe_soluciones os INNER JOIN odpes o on os.id_odpe = o.id
WHERE os.id_solucion= 1 GROUP BY o.nombre_odpe ORDER BY nombre_odpe;

select NOM_ODPE from sufragio_nacional_vertical where COD_ST =1 group by NOM_ODPE;

-- -----------------
SELECT DISTINCT d.id,d.descripcion, 'UN DEPARTAMENTO' AS selector
					FROM proceso_odpes po INNER JOIN odpe_soluciones os ON po.id_odpe = os.id_odpe
					INNER JOIN ubigeos u on os.id_odpe = u.id_odpe INNER JOIN departamentos d on u.id_departamento = d.id
					WHERE po.id_proceso = $this->intIdProceso AND os.id_solucion = $this->intIdSolucion AND u.id_odpe = $this->intIdOdpe;


SELECT DISTINCT p.id, p.descripcion
FROM ubigeos u INNER JOIN provincias p on u.id_departamento = p.id
                    WHERE u.id_odpe = 6 AND u.id_departamento;

SELECT DISTINCT d.id, d.descripcion
FROM ubigeos u INNER JOIN distritos d on u.id_departamento = d.id
WHERE u.id_odpe = 1 AND u.id_provincia;

SELECT c.id, c.descripcion FROM consultas c INNER JOIN odpe_consultas oc on c.id = oc.id_consulta
WHERE oc.id_proceso = 1 AND oc.id_odpe = 1 ORDER BY c.id;

select * FROM sufragio_nacional_vertical WHERE NOM_ODPE= 'ABANCAY' AND DEPAR_UBI= 'APURIMAC' AND PROV_UBI = 'ABANCAY' AND DIST_UBI = 'ABANCAY';

select * from consultas;

SELECT c.id, c.descripcion FROM odpe_consultas oc INNER JOIN consultas c on c.id = oc.id_consulta INNER JOIN ubigeos u on oc.id_odpe = u.id_odpe
WHERE oc.id_proceso = 1 AND oc.id_odpe = 1 AND u.id_departamento AND id_provincia= AND id_departamento ORDER BY c.id;


SELECT * from odpe_consultas oc WHERE oc.id_proceso = 1 AND oc.id_odpe = 1; -- 1,2

SELECT * from consultas c;




